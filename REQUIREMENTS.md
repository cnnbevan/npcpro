# 项目需求说明

## 项目愿景
构建一个 Web 站点，用户输入电影名称和电影角色名称后，系统基于后台数据库中已存储的字幕与电影简介，调用 AI Agent 生成该角色的第一人称叙事，完整描述角色随剧情发展的所见、所思、所为。

## 系统架构概览
- **前端（React + Vite）**：提供输入表单、加载状态、错误提示与生成结果展示，可扩展收藏或导出功能。
- **后端服务（Node/Express，后续可接入 Python Flask 等）**：负责请求处理、数据检索、Prompt 构建与 Agent 调用，返回整理后的第一人称故事。
- **AI Agent 服务**：独立后端能力，按照后端传入 Prompt 输出角色视角的剧情重述。

## 数据与存储
- 使用数据库保存电影元信息、剧情简介与字幕文本，建立基于电影 ID/名称的索引，便于快速检索。
- 可按时间戳或场景切片存储字幕，支持后续按角色或场景筛选。
- 角色背景资料若需补充，可新建表或引用外部知识源，并在 Prompt 中提供引用。

## 核心交互流程
1. 用户提交电影名与角色名。
2. 后端根据电影名检索数据库中的字幕与简介，提取关键片段与剧情节点。
3. 后端结合角色设定构建 Prompt，调用 AI Agent 生成第一人称叙事。
4. 对生成内容做必要的段落化、长度控制或时间线标注后返回前端。
5. 前端展示故事结果，并提供再次生成或调整输入的入口。

## Agent 提示设计要点
- Prompt 包含电影背景、角色性格标签、关键剧情节点与输出格式要求。
- 指定输出语言、视角（第一人称）和语气，确保叙事连贯。
- 根据上下文长度考虑分段生成（检索→总结→润色），必要时追加后处理。

## 近期里程碑
1. 准备首部电影的数据入库与检索接口原型。
2. 实现后端 API：接收请求、检索数据、构建 Prompt 并调用 Agent。
3. 搭建前端原型：输入表单 + 结果展示，以及基础的状态处理。
4. 联调端到端流程，完成首个可演示版本。
5. 根据反馈迭代，扩展多影片支持、角色切换、结果导出等功能。

## 后续考虑
- 成本与性能：评估 Agent 调用频率、上下文长度及缓存策略。
- 权限与安全：规范化 `.env` 配置，保护 API 密钥和数据库凭据。
- 体验优化：增加角色语气调节、章节导航、关键台词回溯等高级特性。
